awk '/^>/ {printf("\n%s\n",$0);next; } { printf("%s",$0);}  END {printf("\n");}' < file.fa > file_unwrapped.fa

^ #I think that this is a simplified version of Kyle's command for unwrapping. "Unwrapping" simply converts documents that run on multiple lines into a single line so blast programs can understand them.

chmod +x add_file+here

^ converts text document into unix exec file (need to do before running stuff)


#make a blank text file and edit it - paste all your query fastas into this file. You can make an nt query or an aa query.
nano name_nt_query.fa
nano name_aa_query.fa

#unwrap the transcriptome
bash 1unwrapFasta.sh name_of_nt_database

#make a nt database out of the unwrapped transcriptome
makeblastdb -in name_of_nt_databaseunwrapped.fa -dbtype nucl

#regs nucleotide BLAST. num threads = number of processors it uses, outfmt 7 is my favorite out format (but you can also have it write to a .csv etc)
blastn -query name_nt_query.fa -db name_of_nt_databaseunwrapped.fa -num_threads 4 -outfmt 7 > name_nt_query.hits

#tblastn if you want to use an amino acid query to search your database
tblastn -query name_aa_query.fa -db name_of_nt_databaseunwrapped.fa -num_threads 4 -outfmt 7 > name_aa_query.hits 

#example: tblastn -query chordin_query -db transcriptome_formatted.fa -num_threads 4 -max_target_seqs 10 -outfmt 7 > chordin_hits

#Grab just the hit IDs out of the .hits file and print them to a file
grep -v "#" name_aa_query.hits | awk '{print $2}' > name_aa_hit_IDs

#example: grep -v "#" chordin_hits | awk '{print $2}' > chordin_hit_IDs

#pull the sequences corresponding to those hit IDs out of the transcriptome
cat name_aa_hit_IDs | while read line; do grep -A 1 $line name_of_nt_databaseunwrapped.fa >> name_aa_query_hit_fastas ; done


#example: cat chordin_hit_IDs | while read line; do grep -A 1 $line /Users/mederioslab/Desktop/Zack/BLAST/transcriptome_formatted.fa >> chordin_hit_fastas ; done


